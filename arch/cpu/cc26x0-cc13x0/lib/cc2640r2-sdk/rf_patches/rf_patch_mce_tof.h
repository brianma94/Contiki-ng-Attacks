/******************************************************************************
*  Filename:       rf_patch_mce_tof.h
*  Revised:        $Date: 2018-05-29 11:48:21 +0200 (ti, 29 mai 2018) $
*  Revision:       $Revision: 18482 $
*
*  Description: RF core patch for supporting time-of-flight radio measurements in CC2640R2F
*
*  Copyright (c) 2015-2017, Texas Instruments Incorporated
*  All rights reserved.
*
*  Redistribution and use in source and binary forms, with or without
*  modification, are permitted provided that the following conditions are met:
*
*  1) Redistributions of source code must retain the above copyright notice,
*     this list of conditions and the following disclaimer.
*
*  2) Redistributions in binary form must reproduce the above copyright notice,
*     this list of conditions and the following disclaimer in the documentation
*     and/or other materials provided with the distribution.
*
*  3) Neither the name of the ORGANIZATION nor the names of its contributors may
*     be used to endorse or promote products derived from this software without
*     specific prior written permission.
*
*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
*  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
*  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
*  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
*  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
*  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
*  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
*  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
*  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
*  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
*  POSSIBILITY OF SUCH DAMAGE.
*
******************************************************************************/

#ifndef _RF_PATCH_MCE_TOF_H
#define _RF_PATCH_MCE_TOF_H

#include <stdint.h>
#include "../inc/hw_types.h"

#ifndef MCE_PATCH_TYPE
#define MCE_PATCH_TYPE static const uint32_t
#endif

#ifndef PATCH_FUN_SPEC
#define PATCH_FUN_SPEC static inline
#endif

#ifndef RFC_MCERAM_BASE
#define RFC_MCERAM_BASE 0x21008000
#endif

#ifndef MCE_PATCH_MODE
#define MCE_PATCH_MODE 0
#endif

MCE_PATCH_TYPE patchTofMce[462] = { 
   0x00036055,
   0x00f1000f,
   0x00000000,
   0x000c8000,
   0x00000000,
   0x0e450000,
   0x80000000,
   0x0000800a,
   0x091e0000,
   0x00500594,
   0x00000000,
   0x00c27c20,
   0x00130000,
   0x00507f7f,
   0xfe6b2840,
   0xdeade8ca,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x07d00011,
   0x6fdd2fea,
   0x0fb00ff0,
   0xf8000003,
   0x007f7f30,
   0x30300010,
   0x8008005a,
   0x01900000,
   0x40000800,
   0xc1020dc5,
   0xc0013162,
   0x1e008150,
   0x1a10404d,
   0x1020604f,
   0x6f131a10,
   0x16116e23,
   0x684f1612,
   0xc0307000,
   0x72206795,
   0xa32d7248,
   0x73057303,
   0x73047203,
   0x72047306,
   0x72767376,
   0x8001c7c0,
   0x90010001,
   0x08019010,
   0x720c9001,
   0x720e720d,
   0x7100b0c0,
   0xb0f0a0c0,
   0x81327218,
   0x39521020,
   0x00200670,
   0x11011630,
   0x6c011401,
   0x6098608a,
   0x614f60b6,
   0x608a61ed,
   0x608a608a,
   0x6098608a,
   0x614f60b6,
   0x608a61ed,
   0x608a608a,
   0x6795c040,
   0xc0506092,
   0x60906795,
   0x60931220,
   0x81811210,
   0x91800010,
   0x6055b070,
   0xc282c011,
   0x1820c560,
   0x6e236f13,
   0x16121611,
   0x7c10689c,
   0xc02297e0,
   0x39818131,
   0xd0601812,
   0x67959862,
   0x40921e01,
   0x97e07c20,
   0x93507bf0,
   0x93007c00,
   0x92d07c30,
   0x6092b330,
   0xc0706722,
   0xb5a091c0,
   0xb76466b4,
   0x66ceb203,
   0x8724a5a0,
   0x87349454,
   0x8ad49464,
   0x86149434,
   0x8ab09444,
   0x40cc2200,
   0xb110b0e0,
   0xb0c0b0e6,
   0xb116b0c5,
   0x7b50b0f0,
   0x90602a00,
   0x1e0ec0a0,
   0x161040d8,
   0xb7629780,
   0xb041c037,
   0xc031b0f5,
   0x7100a760,
   0xb760b073,
   0x8090b88e,
   0x45442200,
   0x1e0280b2,
   0x225044f6,
   0x821040dc,
   0x44f32200,
   0x40dc220f,
   0x674a100f,
   0x100f60dc,
   0x60dc6760,
   0xb204a763,
   0x936cb889,
   0x720ea0c5,
   0xb0f1b0c1,
   0x97877100,
   0x7100b0f1,
   0xc3e0b32d,
   0xb0749780,
   0x93b0c0d0,
   0x95e18791,
   0x8791676b,
   0xb0f11401,
   0xb88b7100,
   0xc210b078,
   0xa2029780,
   0xb0f1b205,
   0xa32d7100,
   0x7276b06e,
   0x8942a0c1,
   0x3d823182,
   0x6795c070,
   0x8a748a63,
   0x06f28982,
   0x314395f2,
   0x00343143,
   0xc8f09604,
   0xb205692a,
   0xa0e0b110,
   0xa0e6b116,
   0x7276b764,
   0xa003a5a0,
   0xc7c0a002,
   0x72039010,
   0x73057204,
   0xa2027306,
   0x8212b205,
   0x453b1e02,
   0xc0807220,
   0x60926795,
   0xa202b205,
   0xd0908792,
   0x67959862,
   0x720c720e,
   0x730f7311,
   0xc00f612c,
   0xc0f06722,
   0x66b491c0,
   0x6795c0a0,
   0xb064b013,
   0x22008ab0,
   0xb0e0415d,
   0xb0e6b110,
   0xb0c5b0c0,
   0xb116b0f1,
   0xb7627276,
   0x1e0ec0a0,
   0x16104168,
   0xc0379780,
   0xb202b041,
   0xa760c031,
   0x7100b0f5,
   0xb760b073,
   0x8090b88e,
   0x45e42200,
   0x1e0280b2,
   0x22504586,
   0x8210416c,
   0x45832200,
   0x416c220f,
   0x674a100f,
   0x100f616c,
   0x616c6760,
   0xb204b763,
   0x936cb889,
   0x720ea0c5,
   0x26408180,
   0xb0c19180,
   0x7100b0f1,
   0x9787b041,
   0x7100b0f1,
   0xc3e0b32d,
   0xb0749780,
   0x93b0c0d0,
   0x7100b0f1,
   0xc210b078,
   0xa2029780,
   0x7100b0f1,
   0xb06ea32d,
   0xa0c1a760,
   0x89a0b88c,
   0x676b9600,
   0x140187e1,
   0x14018170,
   0xb0f69781,
   0x7100b0c6,
   0xa0c6b0f6,
   0x22008090,
   0xb01245e4,
   0x94548724,
   0x94648734,
   0x94348ad4,
   0x94448614,
   0x82007276,
   0x26302a20,
   0x66ce9200,
   0x8601c070,
   0x31828942,
   0xc3103d82,
   0xb06469ce,
   0xb116b0f1,
   0xb110b0e6,
   0xb205b0e0,
   0x1e028212,
   0xb76445d5,
   0xa0037276,
   0xc7c0a002,
   0x72039010,
   0x73057204,
   0x60927306,
   0x6795c0b0,
   0x720eb205,
   0x7311720c,
   0x7276730f,
   0x672261d5,
   0xc0f0c00b,
   0x66b491c0,
   0x6795c0c0,
   0x725fb764,
   0xc0e0b013,
   0x8ab09590,
   0x41fe2200,
   0xb110b0e0,
   0xb064b0f0,
   0xb0c0b0e6,
   0xb116b0c5,
   0xb041b061,
   0x420b1e1b,
   0xb7627276,
   0xc03772ac,
   0x1e0ec030,
   0x16104211,
   0x9780c0b7,
   0xb0f5b202,
   0xa760c031,
   0xb0737100,
   0xb88eb760,
   0x22008090,
   0x80b246a9,
   0x462d1e02,
   0x42132250,
   0x22008210,
   0x220f462a,
   0x100f4213,
   0x6213674a,
   0x6760100f,
   0xb2046213,
   0x42411e1b,
   0xb766a765,
   0xb88bb763,
   0x06f08980,
   0x8a6395f0,
   0x31438a74,
   0x00343143,
   0x81809604,
   0x91802650,
   0xa7636277,
   0x26408180,
   0x97879180,
   0x936cb889,
   0x720ea0c5,
   0xb0f1b0c1,
   0x7100b0f1,
   0xc3e0b32d,
   0xb0749780,
   0x93b0c0d0,
   0x95e18791,
   0xb0f1676b,
   0xb0787100,
   0x9780c210,
   0xb205a202,
   0x7100b0f1,
   0xb06ea32d,
   0xa0c17276,
   0x31828942,
   0xb88b3d82,
   0x06f28982,
   0x85f43142,
   0x95f20042,
   0x8a748a63,
   0x31433143,
   0x96040034,
   0x6a75c8f0,
   0xbac06290,
   0x94548724,
   0x94648734,
   0x94348ad4,
   0x94448614,
   0xa202c01b,
   0x22628212,
   0x72204281,
   0xb0f5b064,
   0xb116b110,
   0xb594b202,
   0x6a8dc410,
   0x6213674a,
   0xb110b205,
   0xb116a0e0,
   0xb764a0e6,
   0xa5a07276,
   0xa002a003,
   0x9010c7c0,
   0x72047203,
   0x73067305,
   0xb205a202,
   0x1e028212,
   0x722046a0,
   0x6795c0d0,
   0xb2056092,
   0x8792a202,
   0x9862d0e0,
   0x720e6795,
   0x7311720c,
   0x6291730f,
   0x22128212,
   0xb00642b4,
   0xb012b016,
   0xb004b002,
   0x7b40b014,
   0x90509030,
   0x90407b50,
   0xb1079060,
   0x7100b0d7,
   0xa0d7b072,
   0x6ac9d680,
   0xc090674a,
   0x700093b0,
   0xc040bac0,
   0xb7619780,
   0xb0c1b760,
   0x7b30b0f1,
   0x6d016d01,
   0x71009ae1,
   0xa0c17276,
   0x7b37b0f1,
   0x94857229,
   0xc0f38ab2,
   0xb013b003,
   0x92908140,
   0x94908160,
   0xb100b0d0,
   0x22027100,
   0x845046f6,
   0x92939490,
   0x7100b100,
   0x94908460,
   0x7100b100,
   0x94908430,
   0xb1009293,
   0x84407100,
   0xb1009490,
   0x8ae07100,
   0xb1009490,
   0x94867100,
   0x9780c040,
   0xb760b761,
   0xb0f1b0c1,
   0xb100a0d0,
   0x72767100,
   0xb0f1a0c1,
   0x1e1085a0,
   0xb2054315,
   0xa765631c,
   0xb763b766,
   0x2a308200,
   0x92002620,
   0x6b1dc090,
   0xc0f0aac0,
   0x70006795,
   0x72187220,
   0x9290c0f0,
   0xc1f1722c,
   0xc01592a1,
   0x7b377b26,
   0x7c407b6c,
   0x8ab09320,
   0x43392200,
   0x94007b90,
   0x94107ba0,
   0x94207bb0,
   0x7bc0633f,
   0x7bd09400,
   0x7be09410,
   0xaac09420,
   0xc1009486,
   0x813e91b0,
   0xc01d398e,
   0x43491e0e,
   0x7000c03d,
   0x724f724e,
   0xb0537b82,
   0xc3b09362,
   0x73886b50,
   0x94e08890,
   0x94f188a1,
   0x7b709366,
   0x88939360,
   0x313388a4,
   0x31343d33,
   0x70003d34,
   0x88939881,
   0x313388a4,
   0x31343d63,
   0x94e33d64,
   0xb05394f4,
   0x1e0e7000,
   0x8a614382,
   0x18108a70,
   0xc0024f7c,
   0x161110d1,
   0x16201812,
   0x1c203d20,
   0x10204f94,
   0x63941610,
   0x3d201620,
   0x4b941cd0,
   0x639410d0,
   0xc082c000,
   0x8a748a63,
   0x9863e100,
   0x67959874,
   0x1c241834,
   0x14424f90,
   0x63944b92,
   0x639410d0,
   0x18d0c000,
   0x98507000,
   0x22008840,
   0xb8304796,
   0x00007000
};

PATCH_FUN_SPEC void rf_patch_mce_tof(void)
{
#ifdef __PATCH_NO_UNROLLING
   uint32_t i;
   for (i = 0; i < 462; i++) {
      HWREG(RFC_MCERAM_BASE + 4 * i) = patchTofMce[i];
   }
#else
   const uint32_t *pS = patchTofMce;
   volatile unsigned long *pD = &HWREG(RFC_MCERAM_BASE);
   uint32_t t1, t2, t3, t4, t5, t6, t7, t8;
   uint32_t nIterations = 57;

   do {
      t1 = *pS++;
      t2 = *pS++;
      t3 = *pS++;
      t4 = *pS++;
      t5 = *pS++;
      t6 = *pS++;
      t7 = *pS++;
      t8 = *pS++;
      *pD++ = t1;
      *pD++ = t2;
      *pD++ = t3;
      *pD++ = t4;
      *pD++ = t5;
      *pD++ = t6;
      *pD++ = t7;
      *pD++ = t8;
   } while (--nIterations);

   t1 = *pS++;
   t2 = *pS++;
   t3 = *pS++;
   t4 = *pS++;
   t5 = *pS++;
   t6 = *pS++;
   *pD++ = t1;
   *pD++ = t2;
   *pD++ = t3;
   *pD++ = t4;
   *pD++ = t5;
   *pD++ = t6;
#endif
}

#endif
